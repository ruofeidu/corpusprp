<script type="text/javascript">
onerror = handleError; 

function handleError(msg, url, line){
	return true; 
}
var searchMode = 1; 

$(document).ready(function(){
$("#errorSearch").hide(); 
$("#infoView").hide();
$("#aboutView").hide();
$("#mysubmit").hide();
$("#clearall").hide(); 

$("#orgTab").click(function(){
	$("#aboutView").hide();
	$("#infoView").hide();
	$("#errorSearch").hide("normal"); 
	$("#keywords")[0].value = ""; 
	$("#clearall").click(); 
	searchMode = 1; 
}); 

$("#errorTab").click(function(){
	$("#aboutView").hide();
	$("#infoView").hide();
	$("#errorSearch").show("normal"); 
	$("#clearall").click(); 
	searchMode = 2; 
});

$("#infoTab").click(function(){
	$("#infoView").hide();
	$("#errorSearch").hide(); 
	$("#aboutView").hide();
	$("#clearall").click(); 
	$("#infoView").show("normal");
});

$("#keywords").keydown(function(event){
	if (event.which == 13) {
		$("#submit").click(); 
		$("#keywords").focus(); 
	}
});

$("#uid").keydown(function(event){
	if (event.which == 13) {
		$("#submit").click(); 
		$("#keywords").focus(); 
	}
});

$("#aboutTab").click(function(){
	$("#infoView").hide();
	$("#errorSearch").hide(); 
	$("#aboutView").hide();
	$("#clearall").click(); 
	$("#aboutView").show("normal");
});

$("#submit").mouseover(function(){
	$("#submit")[0].src = "__PUBLIC__/images/search_glow.jpg";
}); 

$("#submit").mouseout(function(){
	$("#submit")[0].src = "__PUBLIC__/images/search.jpg";
}); 

$("#dlbutton").mouseover(function(){
	$("#dlbutton")[0].src = "__PUBLIC__/images/download_glow.jpg";
}); 

$("#dlbutton").mouseout(function(){
	$("#dlbutton")[0].src = "__PUBLIC__/images/download.jpg";
}); 

$(".submit").click(function(){
	var dl = 0; 
	if (this.id == "dlbutton") {
		dl = 1;
		$("#resultList").html("&nbsp;&nbsp;&nbsp;Excelファイルを作成中です…少々お待ちください。"); 
	} else {
		$("#resultList").html("&nbsp;&nbsp;&nbsp;検索中です…少々お待ちください。"); 
	}
	$('#download')[0].value = dl; 
	var kw = $('#keywords')[0].value;
	var lkw = $('#lastkeywords')[0].value;
	var sc = $('#school')[0].value; 
	var gd = $('#gender')[0].value; 
	var tmin = $('#studytime')[0].value; 
	var tmax = parseInt(tmin) + 150; 

	var fl = $('#firstlang')[0].value; 
	var yr = $('#year')[0].value; 
	var ud = $('#uid')[0].value;  
	var er = $('#error')[0].value; 
	var sp = $('#samepage')[0].value; 
	if (sp == 1) pg = $('#page')[0].value; else {
		pg = 1; 
		$('#page')[0].value = 1; 
	}	
	$('#lastkeywords')[0].value = kw; 
	var ln = $('#listnum')[0].value;
		
	if (dl == 0){
		if (searchMode == 1){
			if (tmin == 0){
				$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, firstlang:fl, year:yr, uid:ud, page:pg, listnum:ln, download:dl} );
			} else {
				$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, timemin: tmin, timemax: tmax, firstlang:fl, year:yr, uid:ud, page:pg, listnum:ln, download:dl} );
			}
		} else { 
			if (tmin == 0){
				$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, firstlang:fl, year:yr, uid:ud, error:er, page:pg, listnum:ln, download:dl} );
			} else {
				$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, timemin: tmin, timemax: tmax, firstlang:fl, year:yr, uid:ud, error:er, page:pg, listnum:ln, download:dl} );
			}
		}
	} else {
		$("#mysubmit").click();
	}
	$('#samepage')[0].value = 0; 
	if (this.id == "dlbutton ") {
		$("#resultList").html("&nbsp;&nbsp;&nbsp;Excelファイルができました。ダウンロードの保存先でご覧ください。"); 
	} 
}); 
}); 
</script>

<div id="search" align="center">
<div class="wrapper">
<div id="header" class="row b-l">
	<div id="logo">
		<a href="{:U("Search/index")}">Corpus</a>
	</div>
	<div class="column grid_1">&nbsp; </div>		
	<ul class="tabs">
		<li class="first"><a href="#tab1" id="orgTab">全文検索</a></li>
		<li><a href="#tab2" id="errorTab">誤用検索</a></li>
		<li><a href="#tab3" id="infoTab">お知らせ</a></li>
		<li><a href="#tab4" id="aboutTab">利用方法</a></li>
	</ul>
</div>
</div>

<div id="form">
<form name="myForm" id="myForm" target="_blank" action="__URL__/search" method="post">
<div class="row">
	<div id="searchBox">
		<div class="column grid_7"><input type="text" id="keywords" name="keywords" style="height:23px;width:95%" class="large bLeft" value="{$keywords}"/> </div>
	</div>
	<div class="column gird_2"><td class="tRight" width="16%"><img class="submit" id="submit" src="__PUBLIC__/images/search.jpg"/> </div>
	<div class="column gird_2"><td class="tRight" width="16%"><img class="submit" id="dlbutton" src="__PUBLIC__/images/download.jpg"/> </div>
</div>
 
<div class="row" id="errorSearch">
	<br/>
	<div class="column grid_1"> 誤用検索：</div>			
	<div class="column grid_2">
		<select id="baseError" style="width:130px">
			<option value="指定なし">指定なし</option>
			<option value="表記の誤用">表記の誤用</option>
			<option value="語の誤り">語の誤り</option>
			<option value="フレーズの誤り">フレーズの誤り</option>
			<option value="文の誤りタイプ">文の誤りタイプ</option>
			<option value="文章構成の誤り">文章構成の誤り</option>
		</select> 
	</div>
 
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="nextError" class="sError" style="width:130px">
			<option value="">指定なし</option>
		</select>
	</div>
	
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="tempError" class="sError" style="width:130px">
			<option value="">指定なし</option>
		</select>
	</div>
	
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="realError" class="sError" style="width:130px">
			<option value="">指定なし</option>
		</select>
	</div>
</div>

<div class="row" id="infoView">
{$newsInfo.content}
</div>

<div class="row" id="aboutView">
{$newsAbout.content}
</div>
 
<div id="seperate" class="row b-l"></div>
<div class="row">
	<div class="column grid_2">執筆者の在籍学校： </div>			
	<div class="column grid_1">
		<select id="school" name="school" style="width:80px">
			<option value="">指定なし</option>
			<option value="j">j</option>
			<option value="d">d</option>
			<option value="s">s</option>
			<option value="w">w</option>
			<option value="n">n</option>
		</select>
	</div>

	<div class="column grid_2">執筆者の性別： </div>			
	<div class="column grid_1">
		<select id="gender" name="gender" style="width:80px">
			<option value="">指定なし</option>
			<option value="男">男</option>
			<option value="女">女</option>
		</select>
	</div>
	
	<div class="column grid_2">日本語学習時間数： </div>			
	<div class="column grid_1">
		<select id="studytime" name="studytime" style="width:80px">
			<option value="0">指定なし</option>
			<option value="700">700-850</option>
			<option value="850">850-900</option>
			<option value="1000">1000-1150</option>
			<option value="1150">1150-1300</option>
			<option value="1300">1300-1450</option>
			<option value="1450">1450-1600</option>
			<option value="1600">1600-1750</option>
			<option value="1750">1750-1900</option>
			<option value="1900">1900-2050</option>
			<option value="2050">2050-2200</option>
			<option value="2200">2200-2350</option>
		</select>
	</div>
	
	<div class="column grid_2">執筆者の母語： </div>			
	<div class="column grid_1">
		<select id="firstlang" name="firstlang" style="width:80px">
			<option value="">指定なし</option>
			<option value="中国语">中国語</option>
			<option value="朝鲜语">朝鮮語</option>
			<option value="蒙古语">モンゴル語</option>
			<option value="英语">英語</option>
		</select>
	</div>
	
	<div class="column grid_2">作成学期：</div>			
	<div class="column grid_1">
		<select id="year" name="year" style="width:80px">
			<option value="">指定なし</option>
			<option value="x3">x3</option>
			<option value="x4">x4</option>
			<option value="x5">x5</option>
			<option value="x6">x6</option>
			<option value="x7">x7</option>
			<option value="x8">x8</option>
		</select>
	</div>
	
	<div class="column grid_2">執筆者番号：</div>			
	<div class="column grid_1">
		<input type="text" id="uid" name="uid" style="width:75px" class="large bLeft">
	</div>
</div>
<div class="row">
	<div class="page column grid_2">1ページの表示件数：</div>
	<div class="column grid_1">
		<input type="number" value="30" id="listnum" name="listnum" style="width:75px" class="large bLeft" min="3" max="90"/>
		<input id="error" name="error" type="hidden" value=""/>
		<input id="page" name="page" type="hidden" value="1"/>
		<input id="samepage" name="samepage" type="hidden" value="1"/>
		<input id="editword" type="hidden" value="1"/>
		<input id="download" name="download" type="hidden" value="1"/>
		<input id="lastkeywords" type="hidden" value="corpus"/>
	</div>
	
	<div class="column grid_3">
		<input type="submit" id="mysubmit" value="excelファイル出力（utf8转gb2312）"/>
		<input type="reset" id="clearall"/>
	</div>
</div>

<div id="seperate" class="row b-l"></div>
</form>
</div>
</div>

</div>
</div>
</div>

<div class="row main" id="resultList">
</div>
<div id="downloadList">
</div>