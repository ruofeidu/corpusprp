<script type="text/javascript">
onerror = handleError; 

function handleError(msg, url, line){
	var message = "本页存在错误。\n";
	message += "错误：" + msg + "\n";
	message += "URL：" + url + "\n"; 
	message += "行号：" + line + "\n"; 
	message += "点击确定继续";
	//alert(message);
	return true; 
}
var searchMode = 1; 

$(document).ready(function(){
$("#errorSearch").hide(); 
$("#infoView").hide();
$("#aboutView").hide();
$("#mysubmit").hide();

$("#orgTab").click(function(){
	$("#aboutView").hide();
	$("#infoView").hide();
	$("#errorSearch").hide("normal"); 
	searchMode = 1; 
}); 

$("#errorTab").click(function(){
	$("#aboutView").hide();
	$("#infoView").hide();
	$("#errorSearch").show("normal"); 
	searchMode = 2; 
});

$("#infoTab").click(function(){
	$("#infoView").hide();
	$("#errorSearch").hide(); 
	$("#aboutView").hide();

	$("#infoView").show("normal");
});

$("#aboutTab").click(function(){
	$("#infoView").hide();
	$("#errorSearch").hide(); 
	$("#aboutView").hide();

	$("#aboutView").show("normal");
});

$(".submit").click(function(){
	var dl = 0; 
	if (this.id == "download") {
		dl = 1;
		//alert("下载");
		$("#resultList").html("下载中...请耐心等待..."); 
	} else {
		//alert("搜索");
		$("#resultList").html("检索中...请耐心等待..."); 
	}
	$('#download')[0].value = dl; 
	var kw = $('#keywords')[0].value;
	var lkw = $('#lastkeywords')[0].value;
	var sc = $('#school')[0].value; 
	var gd = $('#gender')[0].value; 
	var st = $('#studytime')[0].value; 
	var fl = $('#firstlang')[0].value; 
	var yr = $('#year')[0].value; 
	var ud = $('#uid')[0].value; 
	var er = $('#error')[0].value; 
	if (kw == lkw) pg = $('#page')[0].value; else pg = 1;  
	$('#lastkeywords')[0].value = kw; 
	var ln = $('#listnum')[0].value;; 
	
	if (dl == 0){
		if (searchMode == 1)
			$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, studytime: st, firstlang:fl, year:yr, uid:ud, page:pg, listnum:ln, download:dl} );
		else 
			$("#resultList").load("__URL__/search" , { keywords: kw, school: sc, gender: gd, studytime: st, firstlang:fl, year:yr, uid:ud, error:er, page:pg, listnum:ln, download:dl} );
	} else {
			//$("#myForm").submit();
			//alert("已经提交");
		$("#mysubmit").click();
		//if (searchMode == 1){
		//	$.ajax({ type: "POST", url: "__URL__/search", data:  { keywords: kw, school: sc, gender: gd, studytime: st, firstlang:fl, year:yr, uid:ud, page:pg, listnum:ln, download:dl},  success: function(str_response) {  var obj = window.open("about:blank");  obj.document.write(str_response);  } });  
		//} else { 
		//	$.ajax({  type: "POST", url: "__URL__/search",  data: { keywords: kw, school: sc, gender: gd, studytime: st, firstlang:fl, year:yr, uid:ud, error:er, page:pg, listnum:ln, download:dl},  success: function(str_response) {  var obj = window.open("about:blank");  obj.document.write(str_response);  }  });  
		//}
	}
}); 
}); 
</script>

<div id="search" align="center">
<div class="wrapper">
<div id="header" class="row b-l">
	<div id="logo">
		<a href="{:U("Search/index")}">Corpus</a>
	</div>
	<div class="column grid_1">&nbsp; </div>		
	<ul class="tabs">
		<li class="first"><a href="#tab1" id="orgTab">原文检索</a></li>
		<li><a href="#tab2" id="errorTab">错误检索</a></li>
		<li><a href="#tab3" id="infoTab">语料库信息</a></li>
		<li><a href="#tab4" id="aboutTab">关于</a></li>
	</ul>
</div>
</div>

<div id="form">
<form name="myForm" id="myForm" target="_blank" action="__URL__/search" method="post">
<div class="row">
	<div id="searchBox">
		<div class="column grid_7"><input type="text" id="keywords" name="keywords" style="height:23px;width:95%" class="large bLeft" value="{$keywords}"/> </div>
	</div>
	<div class="column gird_2"><td class="tRight" width="16%"><img class="submit" id="submit" src="__PUBLIC__/images/search.png"/> </div>
	<div class="column gird_2"><td class="tRight" width="16%"><img class="submit" id="download" src="__PUBLIC__/images/download.png"/> </div>
</div>
 
<div class="row" id="errorSearch">
	<br/>
	<div class="column grid_1"> 错误检索： </div>			
	<div class="column grid_2">
		<select id="baseError" style="width:130px">
			<option value="所有类型">不限</option>
			<option value="书写错误">书写错误</option>
			<option value="词语错误">词语错误</option>
			<option value="词组错误">词组错误</option>
			<option value="句子错误">句子错误</option>
			<option value="文章格式">文章格式</option>
		</select> 
	</div>
 
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="nextError" class="sError" style="width:130px">
			<option value="">不限</option>
		</select>
	</div>
	
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="tempError" class="sError" style="width:130px">
			<option value="">不限</option>
		</select>
	</div>
	
	<div class="column grid_1">  </div>			
	<div class="column grid_2">
		<select id="realError" class="sError" style="width:130px">
			<option value="">不限</option>
		</select>
	</div>
</div>

<div class="row" id="infoView">
本语料库系统目前收录修改后的作文2920篇。
</div>

<div class="row" id="aboutView">
本语料库系统由<a href="http://www.duruofei.com" target="_blank">杜若飞</a>、<a href="http://www.yepyao.info" target="_blank">幺恩鹏</a>、陈博在张建华老师指导下开发。
友情链接：<a href="http://www.todict.com" target="_blank">兔词典</a>、<a href="http://www.douniwan.info" target="_blank">逗你玩</a>、<a href="http://www.acmclass.com" target="_blank">ACM班</a>
</div>
 
<div id="seperate" class="row b-l"></div>
<div class="row">
	<div class="column grid_1">作者学校： </div>			
	<div class="column grid_2">
		<select id="school" name="school" style="width:130px">
			<option value="">不限</option>
			<option value="東北師範大学">d</option>
			<option value="南開大学">n</option>
			<option value="上海師範大学">s</option>
			<option value="上海外国語大学">w</option>
			<option value="上海交通大学">j</option>
		</select>
	</div>

	<div class="column grid_1">作者性别： </div>			
	<div class="column grid_2">
		<select id="gender" name="gender" style="width:130px">
			<option value="">不限</option>
			<option value="男">男</option>
			<option value="女">女</option>
		</select>
	</div>
	
	<div class="column grid_1">学习时间： </div>			
	<div class="column grid_2">
		<select id="studytime" name="studytime" style="width:132px">
			<option value="">不限</option>
			<option value="A">A</option>
			<option value="B">B</option>
			<option value="C">C</option>
			<option value="D">D</option>
			<option value="E">E</option>
		</select>
	</div>
	
	<div class="column grid_1">学生母语： </div>			
	<div class="column grid_2">
		<select id="firstlang" name="firstlang" style="width:130px">
			<option value="">不限</option>
			<option value="中国語">中国语</option>
			<option value="朝鮮語">朝鲜语</option>
			<option value="モンゴル語">蒙古语</option>
			<option value="英語">英语</option>
			<option value="韓国語">韩国语</option>
		</select>
	</div>
	
	<div class="column grid_1">写作学期：</div>			
	<div class="column grid_2">
		<select id="year" name="year" style="width:130px">
			<option value="">不限</option>
			<option value="x4">x4</option>
			<option value="x5">x5</option>
			<option value="x6">x6</option>
			<option value="x7">x7</option>
			<option value="x8">x8</option>
			<option value="x9">x9</option>
		</select>
	</div>
	
	<div class="column grid_1">作者代码：</div>			
	<div class="column grid_2">
		<input type="text" id="uid" name="uid" style="width:130px" class="large bLeft">
	</div>
</div>
<div class="row">
	<div class="page column grid_1">每页条目：</div>
	<div class="column grid_2">
		<input type="number" value="30" id="listnum" name="listnum" style="width:130px" class="large bLeft" min="3" max="90"/>
		<input id="error" name="error" value=""/>
		<input id="page" name="page" type="hidden" value="1"/>
		<input id="editword" type="hidden" value="1"/>
		<input id="download" name="download" type="hidden" value="1"/>
		<input id="lastkeywords" type="hidden" value="corpus"/>
	</div>
	
	<div class="column grid_3">
		<input type="submit" id="mysubmit" value="输出excel文件（utf8转gb2312）"/>
	</div>
</div>

<div id="seperate" class="row b-l"></div>
</form>
</div>
</div>

</div>
</div>
</div>

<div class="row main" id="resultList">
</div>
<div id="downloadList">
</div>